<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LitVM Arcade Hub</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Audiowide&family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles/main.css">
</head>

<body>
    <!-- Background System -->
    <div class="cyber-grid-container">
        <div class="cyber-grid"></div>
    </div>
    <div class="bg-vignette"></div>

    <!-- HUD Header -->
    <header class="glass-panel" style="border-radius: 0; border-top: none; border-left: none; border-right: none;">
        <div class="header-left">
            <div class="logo">LitVM Arcade</div>
        </div>

        <div id="auth-container" class="header-right">
            <!-- 1. Disconnected State -->
            <button id="btn-connect-wallet" class="btn-neon">Connect Wallet</button>

            <!-- 2. Connected State -->
            <div id="user-dashboard-header" style="display: none;">

                <!-- Group 1: Economy (Coins + Streak) -->
                <div class="header-group economy-group">
                    <div id="daily-streak-container" class="stat-pill" title="Daily Streak">
                        <span class="stat-icon">üî•</span>
                        <span id="streak-count">0</span>
                    </div>
                    <div class="stat-pill" title="Balance">
                        <span class="stat-icon">ü™ô</span>
                        <span id="litcoin-balance">0</span>
                    </div>
                </div>

                <!-- Group 2: Player Identity (XP + Level + Avatar + Nick) -->
                <div class="header-group player-group">

                    <!-- XP & Level Group -->
                    <div class="xp-level-container">
                        <span class="level-text">LVL <span id="header-level">1</span></span>
                        <div class="xp-container" title="Experience">
                            <div class="xp-bar-bg">
                                <div id="header-xp-fill" class="xp-bar-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- User Identity (Trigger for Dropdown) -->
                    <div class="user-identity-container">
                        <div class="identity-info" id="user-profile-trigger">
                            <span id="header-nickname" class="nickname">Guest</span>
                            <div id="header-avatar" class="avatar-circle"></div>
                        </div>

                        <!-- Dropdown Menu -->
                        <!-- Profile Card Dropdown -->
                        <div id="user-dropdown" class="profile-card-dropdown">
                            <!-- Avatar & Identity -->
                            <div class="profile-header-section">
                                <div class="avatar-large-container" id="profile-avatar-container">
                                    <div id="profile-avatar-display" class="avatar-large"></div>
                                    <div class="avatar-edit-badge">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                    </div>
                                    <!-- Avatar Selector (Hidden by default) -->
                                    <div id="avatar-selector" class="avatar-selector-grid">
                                        <div class="avatar-option" data-avatar="1"
                                            style="background: linear-gradient(135deg, #00f3ff, #bc13fe)"></div>
                                        <div class="avatar-option" data-avatar="2"
                                            style="background: linear-gradient(135deg, #ff0055, #ffcc00)"></div>
                                        <div class="avatar-option" data-avatar="3"
                                            style="background: linear-gradient(135deg, #00ff99, #00ccff)"></div>
                                        <div class="avatar-option" data-avatar="4"
                                            style="background: linear-gradient(135deg, #ffffff, #888888)"></div>
                                    </div>
                                </div>
                                <div class="nickname-wrapper">
                                    <input type="text" id="dd-input-nickname" class="profile-nickname-input"
                                        placeholder="Enter Codename" maxlength="12" value="Guest">
                                    <svg class="nickname-edit-icon" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                    </svg>
                                </div>
                                <div class="profile-level-badge">LEVEL <span id="dd-level">1</span></div>
                            </div>

                            <div class="profile-divider"></div>

                            <!-- Stats Grid -->
                            <div class="profile-stats-grid">
                                <div class="p-stat-item">
                                    <span class="p-stat-label">Games</span>
                                    <span class="p-stat-value" id="dropdown-wins">0</span>
                                    <span class="stat-subtext" style="visibility: hidden;">placeholder</span>
                                </div>
                                <div class="p-stat-item">
                                    <span class="p-stat-label">Rank</span>
                                    <span class="p-stat-value">#<span id="dropdown-rank">--</span></span>
                                    <span class="stat-subtext">Play more to reveal</span>
                                </div>
                                <div class="p-stat-item">
                                    <span class="p-stat-label">Wallet</span>
                                    <span class="p-stat-value-sm" id="dropdown-wallet-address">0x...</span>
                                    <button id="btn-copy-address" class="btn-copy-sm" title="Copy">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2-2v1"></path>
                                        </svg>
                                    </button>
                                    <span id="copy-feedback" class="copy-feedback">Copied!</span>
                                </div>
                            </div>

                            <!-- Actions Footer -->
                            <div class="profile-actions-row">
                                <button class="p-action-btn" id="dd-link-google">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="currentColor">
                                        <path
                                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.76h3.57c2.08-1.92 3.27-4.74 3.27-8.09z" />
                                        <path
                                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                                        <path
                                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                                        <path
                                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                                    </svg>
                                    <span>Google</span>
                                </button>
                                <button class="p-action-btn" id="dd-link-twitter">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="currentColor">
                                        <path
                                            d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
                                        </path>
                                    </svg>
                                    <span>Twitter</span>
                                </button>
                                <button class="p-action-btn danger" id="dd-disconnect">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                        <polyline points="16 17 21 12 16 7"></polyline>
                                        <line x1="21" y1="12" x2="9" y2="12"></line>
                                    </svg>
                                    <span>Log Out</span>
                                </button>
                            </div>

                            <!-- Hidden File Input -->
                            <input type="file" id="file-upload-avatar" accept="image/png, image/jpeg"
                                style="display: none;">
                        </div>
                    </div>

                </div>
            </div>
    </header>

    <main>
        <!-- Dashboard View -->
        <div id="dashboard" class="dashboard-grid">

            <!-- Games Grid -->
            <section class="games-section">
                <!-- Active Game -->
                <div class="game-card glass-panel" data-game-id="lit-2048">
                    <h3>2048</h3>
                    <p>Cybernetic Puzzle</p>
                    <div style="margin-top: 10px; font-size: 0.8rem; color: var(--color-primary);">Best: <span
                            id="record-lit-2048">0</span></div>
                </div>

                <!-- Coming Soon placeholders -->
                <div class="game-card glass-panel disabled">
                    <h3>Neon Flappy</h3>
                    <p>Coming Soon</p>
                </div>
                <div class="game-card glass-panel disabled">
                    <h3>Cyber Slots</h3>
                    <p>Coming Soon</p>
                </div>
            </section>

        </div>

        </div>

        <!-- Leaderboard View (Hidden by default) -->
        <div id="leaderboard-view" style="display: none; width: 100%; max-width: 800px; margin: 40px auto;">
            <div class="glass-panel" style="padding: 30px;">
                <h2
                    style="color: var(--color-primary); margin-bottom: 20px; text-align: center; text-transform: uppercase;">
                    Global Rankings</h2>
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Player</th>
                            <th style="text-align: right;">Coins</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-list">
                        <!-- Leaderboard Mock Data -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Profile View (Hidden) -->
        <div id="profile-view">

            <!-- Badges Showcase -->
            <div class="glass-panel badges-showcase-panel">
                <div class="badges-showcase-header">
                    <h3 class="badges-showcase-title">BADGES</h3>
                    <span class="badges-progress" id="badges-progress">0 / 8 UNLOCKED</span>
                </div>
                <div class="badges-grid" id="badges-container">
                    <!-- Badges rendered dynamically by JS -->
                </div>
            </div>

            <!-- Recent Transactions (Placeholder until crypto integration) -->
            <div class="glass-panel transactions-panel">
                <div class="transactions-header">
                    <h3 class="transactions-title">RECENT TRANSACTIONS</h3>
                </div>
                <div class="transactions-list" id="transactions-container">
                    <div class="transactions-empty">No transactions yet.</div>
                </div>
            </div>

            <!-- Badge Detail Modal -->
            <div id="badge-detail-modal" class="modal-overlay" style="display:none;">
                <div class="badge-detail-card">
                    <div class="badge-detail-icon" id="badge-detail-icon"></div>
                    <h3 class="badge-detail-name" id="badge-detail-name"></h3>
                    <p class="badge-detail-desc" id="badge-detail-desc"></p>
                    <div class="badge-detail-status" id="badge-detail-status"></div>
                </div>
            </div>
        </div>

        <!-- Game Stage (Hidden) -->
        <div id="game-stage">
            <!-- Game Canvas/DOM injected here -->
        </div>
        <button id="back-to-hub" class="btn-neon"
            style="position: fixed; top: 90px; left: 20px; display: none; z-index: 2500; pointer-events: auto;">&larr;
            Hub</button>
    </main>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay">
        <!-- Missions Modal -->
        <div id="modal-missions" class="modal glass-panel">
            <div class="modal-header">
                <h2>Active Missions</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div id="tasks-list" class="modal-content">
                <!-- Tasks injected by JS -->
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="modal-confirm" class="modal glass-panel" style="max-width: 400px; text-align: center;">
            <h3 id="confirm-title" style="color: var(--color-primary); margin-bottom: 15px;">Confirm Action</h3>
            <p id="confirm-message">Are you sure?</p>
            <div class="modal-actions" style="display: flex; justify-content: center; gap: 15px;">
                <button id="btn-confirm-yes" class="btn-neon-sm">Yes</button>
                <button id="btn-confirm-no" class="btn-neon-sm"
                    style="border-color: #ff3333; color: #ff3333;">No</button>
            </div>
        </div>

        <!-- Alert Modal -->
        <div id="modal-alert" class="modal glass-panel" style="max-width: 400px; text-align: center;">
            <h3 id="alert-title" style="color: var(--color-primary); margin-bottom: 15px;">SYSTEM MESSAGE</h3>
            <p id="alert-message">Alert text</p>
            <div class="modal-actions" style="display: flex; justify-content: center;">
                <button id="btn-alert-ok" class="btn-neon-sm">OK</button>
            </div>
        </div>
    </div>

    <!-- Navigation Dock -->
    <div class="dock-container">
        <div class="dock glass-panel">
            <button id="btn-missions" class="dock-item">
                <span class="dock-icon">üéØ</span>
                <span class="dock-label">MISSIONS</span>
            </button>
            <button id="btn-games" class="dock-item active">
                <span class="dock-icon">üïπÔ∏è</span>
                <span class="dock-label">GAMES</span>
            </button>
            <button id="btn-leaderboard" class="dock-item">
                <span class="dock-icon">üèÜ</span>
                <span class="dock-label">RANKING</span>
            </button>
            <button id="btn-profile" class="dock-item">
                <span class="dock-icon">üéñÔ∏è</span>
                <span class="dock-label">AWARDS</span>
            </button>
        </div>
    </div>

    <!-- Main Logic -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="js/main.js"></script>

</body>

</html>